<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <style>
        #map {position: absolute;
            top: 0;
            bottom: 0;
            left: 400px;
            right: 0;
            width: 800px;
            height: 800px;
        }
        .popup {
            fontsize: 1.1rem;
        }

    </style>
</head>
<body>
    <h1>List of soldiers:</h1>
    <input type="text" id="Name" placeholder="Enter name">
    <button onclick="fetchData()">Fetch</button><br>
    <script src="index.js"></script>

    <img src="", alt="Pokemon Sprite" id="pokemonSprite" style="display: none">

    <script>

        // JavaScript code
        fetch('http://localhost:8082/location', {
            headers: {
                'Access-Control-Allow-Origin':'*'
            }
        })
                .then(response => response.json())
                .then(data => {
                    // Process the JSON data
                    console.log(data);
                })
                .catch(error => {
                    console.error('Error fetching data:', error);
                });
    </script>


    <div id = "map"></div>
</body>
<script>
    const map = L.map('map');
    map.setView([51.713,19.413], 7);

    L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
    }).addTo(map);

    const data = {
        pbaranowski:{
            loc: [51.74705,19.45585],
            firstName: "Piotr",
            lastName: "Baranowski",
            phoneNumber: "98764321",
            rank: "szeregowy",
        },
        klesniewski:{
            loc: [51.74606,19.45562],
            firstName: "Karol",
            lastName: "Lesniewski",
            phoneNumber: "123456789",
            rank: "szeregowy",
        }
    }

    const customIcon = L.icon({
        iconUrl: './static/ranks_icons/szeregowy.png',
        iconSize: [70,53],
    })

    for (let key in data) {
        const soldier = data[key];
        L.marker(soldier.loc, {
            title: soldier.firstName + " " + soldier.lastName,
            icon: customIcon,
        }).bindPopup(`
            <span class="popup">
            <b>${soldier.firstName}
            ${soldier.lastName}</b><br>
            ${soldier.rank}<br>
            Call: <a href="tel:${soldier.phoneNumber}">${soldier.phoneNumber}</a></span>`)
            .addTo(map);
    }

</script>

</html>